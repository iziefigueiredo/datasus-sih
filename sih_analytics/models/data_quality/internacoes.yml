version: 2

sources:
  - name: public
  
    tables:
      - name: internacoes
        columns:
          - name: '"N_AIH"'
            tests:
              - not_null
              - unique
          - name: '"CNES"'
            tests:
              - not_null
          
          - name: '"DT_INTER"'
            tests:
              - not_null

          - name: '"NASC"'
            tests:
              - not_null

          - name: '"MUNIC_RES"'
            tests:
              - not_null
          
          - name: '"SEXO"'
            tests:
              - accepted_values:
                  arguments:
                    values: [1, 3]

          - name: '"PROC_REA"'
            tests:
              - not_null
          
          - name: '"VAL_TOT"'
            tests:
              - not_null   
 
      

          - name: '"VAL_SP"'
            tests:
              - not_null
                     

          - name: '"MUNIC_MOV"'
            tests:
              - not_null

          - name: '"IDADE"'
            tests:
              - not_null
              - dbt_utils.expression_is_true:
                  arguments:
                    expression: " >= 0"        

              